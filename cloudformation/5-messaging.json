{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "infraestructura - recursos queue y sns",
    "Metadata": {},
    "Parameters": {},
    "Mappings": {},
    "Conditions": {},
    "Resources": {
        "myQueue": {
            "Type": "AWS::SQS::Queue",
            "DependsOn": "myQueueFallas",
            "Properties": {
                "RedrivePolicy": {
                    "deadLetterTargetArn": {
                        "Fn::GetAtt": [
                            "myQueueFallas",
                            "Arn"
                        ]
                    },
                    "maxReceiveCount": 5
                }
            }
        },
        "myQueueFallas": {
            "Type": "AWS::SQS::Queue"
        },
        "mySNSTopic": {
            "Type": "AWS::SNS::Topic",
            "Properties": {
                "Subscription": [
                    {
                        "Endpoint": {
                            "Fn::GetAtt": [
                                "myQueue",
                                "Arn"
                            ]
                        },
                        "Protocol": "sqs"
                    }
                ],
                "TopicName": "topicoCurso"
            }
        }
    },
    "Outputs": {
        "arnTopicoSNS": {
            "Description": "ARN de SNS que envia datos a SQS",
            "Value": {
                "Ref" : "mySNSTopic"
            },
            "Export": {
                "Name": "infraestructura-arnTopicoSNS"
            }
        },
        "nameQueue": {
            "Description": "nombre de la cola creada por CF",
            "Value": {
                "Fn::GetAtt": [
                    "myQueue",
                    "QueueName"
                ]
            },
            "Export": {
                "Name": "infraestructura-nameQueue"
            }
        }
    }
}